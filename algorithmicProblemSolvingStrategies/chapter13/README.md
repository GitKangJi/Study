13장 수치 해석
====================================

## 01. 도입
#### &nbsp;수치 해석(numerical analysis)은 직접 풀기 힘든 수학 문제를 근사적으로 푸는 알고리즘과 이들을 수치적 안정성, 오차의 범위 등을 연구하는 전산학의 한 분야로 다양한 범위에 널리 사용된다.

## 02. 이분법
#### &nbsp;가장 유용하게 사용되는 수치 해석 기법은 이분법(bisection method)이다.

* ### 이분법의 정의
#### &nbsp;이분법은 주어진 범위 [lo, hi] 내에서 어떤 함수 f(x)의 값이 0이 되는 지점을 수치적으로 찾아내는 기법이다. 단조 함수가 아니고, 답이 여러 개 있는 함수라도 연속이기만 하면 이분법을 사용해 근을 찾을 수 있다. 이분법을 사용하기 위해서 함수의 그래프 상에서 x축 윗부분에 위치한 점 하나와 아랫부분에 위치한 점 하나를 찾아야 한다. 이런 후보의 중간 지점을 검사한다. 이런 과정을 통해 계속 절반으로 줄여 나가며 답을 찾는다.
```c++
double f(double x);
// 이분법의 예제 구현
double bisection(double lo, double hi) {
	// 반복문 불변식을 강제한다.
	if(f(lo) > 0)
		swap(lo, hi);
	// 반복문 불변식: f(lo) <= 0 < f(hi)
	while(fabs(hi - lo) > 2e-7) {
		double mid = (lo + hi) / 2;
		double fmid = f(mid);
		if(fmid <= 0)
			lo = mid;
		else
			hi = mid;
	}
	// 가운데 값을 반환한다
		return (lo + hi) / 2;
}
```

* ### 절대 오차를 이용한 종료 판정
#### &nbsp;이분법에서 가장 중요한 부분은 바로 while문의 종료 조건이다. 정확도와 수행 속도 사이에서 적절히 타협하는 종료 조건을 선택해야 한다. 문제의 정답이 10^-7이하의 차이가 나는 답들을 정답으로 인정할 때 fabs(hi - lo) > 2e-7와 같은 비교문을 while 조건문으로 넣는다. 반복문 불변식을 강제하기 위해 lo > hi가 될 수도 있기 때문에 항상 hi - lo의 절대 값을 취해야 한다.

* ### 상대 오차를 이용한 종료 판정
#### &nbsp;값의 크기가 커지면 문제가 생길 수 있다.

* ### 정해진 횟수만큼 반복하기
#### &nbsp;가장 유용한 방법은 while문을 적당한 for문으로 대체해서 반복문이 항상 정해진 횟수만큼 실행되도록 하는 것이다. 100번 정도만 실행해도 hi - lo가 10^20미만의 수라면 이 오차는 항상 10^-7보다 작다.

* ### 예제: 다변수 다항 방정식의 수치적 해법(문제 ID: ROOTS, 난이도: 중)
#### &nbsp;다변수 다항 방정식이랑 ax^2 + bx + c = 0 처럼 변수 하나만을 갖는 다항 방정식을 뜻한다. 5차 이상의 방정식은 아예 근의 공식이 없다. 어디까지나 이분법의 예제로만 받아들이고, 실제로는 수치 해석 알고리즘을 이용해야 한다. 다항식의 두 극점 사이에는 최대 하나의 근만이 있다. 따라서 극점들의 위치를 알아낼 수 있다면 그 사이에서 이분법을 이용해 근을 찾을 수 있을 것이다. 

* ### 예제: 전세금 균등상환(문제 ID: LOAN, 난이도: 하)
#### &nbsp;